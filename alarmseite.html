<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Krypto-Alarm Post-it</title>
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    body {
      background: #1b1b1b;
      color: #eee;
      font-family: Arial, sans-serif;
    }

    .alarm-note {
      position: fixed;
      top: 20px;
      width: 220px;
      background: #cceeff;
      color: #222;
      font-size: 13px;
      padding: 12px;
      border-radius: 6px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.25);
      z-index: 9999;
      cursor: grab;
      user-select: none;
    }

    .alarm-note.dragging {
      opacity: 0.85;
      cursor: grabbing;
    }

    .alarm-note a {
      color: #0077aa;
      text-decoration: none;
      font-weight: bold;
      display: inline-flex;
      align-items: center;
      margin-top: 8px;
    }

    .alarm-note a:hover {
      text-decoration: underline;
    }

    .alarm-note .feather {
      width: 14px;
      height: 14px;
      margin-left: 5px;
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <h1 style="padding: 20px;">Testseite für Krypto-Alarm</h1>
  <button onclick="triggerTest()">Alarm Test auslösen</button>

  <script>
    let positions = [20, 260, 500];
    let noteIndex = 0;

    function showAlarm(symbol, price, entry) {
      if (noteIndex >= positions.length) return;

      const note = document.createElement("div");
      note.className = "alarm-note";
      note.style.left = positions[noteIndex] + "px";

      note.innerHTML = \`
        <strong>\${symbol}</strong><br>
        Kurs: \${price.toFixed(2)} USDT<br>
        Einstieg: \${entry.toFixed(2)} USDT<br>
        <a href="coin.html?symbol=\${symbol}" target="_blank">
          Coin öffnen <i data-feather="external-link"></i>
        </a>
      \`;

      document.body.appendChild(note);
      noteIndex++;

      feather.replace();

      const sound = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
      sound.play().catch(() => {
        console.warn("Ton konnte nicht automatisch abgespielt werden.");
      });

      let isDragging = false, startX = 0;

      note.addEventListener("mousedown", e => {
        isDragging = true;
        startX = e.clientX - note.offsetLeft;
        note.classList.add("dragging");
      });

      document.addEventListener("mousemove", e => {
        if (!isDragging) return;
        e.preventDefault();
        note.style.left = \`\${e.clientX - startX}px\`;
      });

      document.addEventListener("mouseup", () => {
        isDragging = false;
        note.classList.remove("dragging");
      });
    }

    function triggerTest() {
      showAlarm("BTCUSDT", 66400.50, 66000.00);
    }
  </script>
</body>
</html>
